from PyQt5 import QtGui, QtCore
from PyQt5.QtWidgets import QSlider

class DoubleSlider(QSlider):
    mouseRelease = QtCore.pyqtSignal(object)
    valueChanged = QtCore.pyqtSignal(float)

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.decimals = 5
        self._max_int = 10 ** self.decimals

        super().setMinimum(0)
        super().setMaximum(self._max_int)

        self._min_value = 0.0
        self._max_value = 1.0

        super().valueChanged.connect(self._value_changed_adapter)

    def _value_changed_adapter(self):
        self.valueChanged.emit(self.value())

    @property
    def _value_range(self):
        return self._max_value - self._min_value

    def value(self):
        return float(super().value()) / self._max_int * self._value_range + self._min_value

    def setValue(self, value):
        super().setValue(int((value - self._min_value) / self._value_range * self._max_int))

    def setMinimum(self, value):
        if value > self._max_value:
            raise ValueError("Minimum limit cannot be higher than maximum")

        self._min_value = value
        self.setValue(self.value())

    def setMaximum(self, value):
        if value < self._min_value:
            raise ValueError("Minimum limit cannot be higher than maximum")

        self._max_value = value
        self.setValue(self.value())

    def minimum(self):
        return self._min_value

    def maximum(self):
        return self._max_value

    def mouseReleaseEvent(self, ev: QtGui.QMouseEvent) -> None:
        self.mouseRelease.emit('mouse release')
        super(DoubleSlider, self).mouseReleaseEvent(ev)